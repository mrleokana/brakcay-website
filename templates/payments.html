{% extends "base.html" %}
{% block title %}Payments â€” BraKcay{% endblock %}
{% block content %}

<section class="payments-section">
  <h2>Make a Payment</h2>
  <p>Choose your payment method. (Dummy functionality for testing)</p>

  {% if result %}
    {% if result.status=='success' %}
      <div class="payment-success">
        <p>Payment Successful!</p>
        <p>Method: {{ result.method }}</p>
        <p>Amount: {{ result.amount }}</p>
        <p>Transaction ID: {{ result.tx_id }}</p>
        <p>Time: {{ result.time }}</p>
      </div>
    {% else %}
      <div class="payment-error">
        <p>Error: {{ result.message }}</p>
      </div>
    {% endif %}
  {% endif %}

  <form method="POST" id="payment-form">
    <label>Amount (USD)</label>
    <input type="number" name="amount" min="1" required>

    <label>Payment Method</label>
    <select name="payment-method" id="payment-method" required>
      <option value="visa">Visa/MasterCard</option>
      <option value="mpesa">Mpesa</option>
      <option value="ecocash">EcoCash</option>
      <option value="crypto">Cryptocurrency</option>
    </select>

    <div id="visa-fields" class="payment-fields">
      <label>Card Number</label>
      <input type="text" name="card-number" placeholder="1234 5678 9012 3456">
      <label>Expiry (MM/YY)</label>
      <input type="text" name="expiry" placeholder="12/25">
      <label>CVV</label>
      <input type="text" name="cvv" placeholder="123">
    </div>

    <div id="mpesa-fields" class="payment-fields" style="display:none;">
      <label>Mpesa Number</label>
      <input type="text" name="mpesa-number" placeholder="07XXXXXXXX">
    </div>

    <div id="ecocash-fields" class="payment-fields" style="display:none;">
      <label>EcoCash Number</label>
      <input type="text" name="ecocash-number" placeholder="07XXXXXXXX">
    </div>

    <div id="crypto-fields" class="payment-fields" style="display:none;">
      <label>Cryptocurrency</label>
      <select name="crypto-coin">
        <option value="BTC">Bitcoin (BTC)</option>
        <option value="ETH">Ethereum (ETH)</option>
        <option value="USDT">USDT</option>
        <option value="BNB">Binance Coin (BNB)</option>
      </select>
      <label>Wallet Address</label>
      <input type="text" name="wallet-address" placeholder="0x...">
    </div>

    <button type="submit">Pay Now</button>
  </form>
</section>

{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded',function(){
  const select = document.getElementById('payment-method');
  const visa = document.getElementById('visa-fields');
  const mpesa = document.getElementById('mpesa-fields');
  const ecocash = document.getElementById('ecocash-fields');
  const crypto = document.getElementById('crypto-fields');

  function toggleFields(){
    visa.style.display = mpesa.style.display = ecocash.style.display = crypto.style.display = 'none';
    switch(select.value){
      case 'visa': visa.style.display='block'; break;
      case 'mpesa': mpesa.style.display='block'; break;
      case 'ecocash': ecocash.style.display='block'; break;
      case 'crypto': crypto.style.display='block'; break;
    }
  }

  select.addEventListener('change', toggleFields);
  toggleFields();
});
</script>
{% endblock %}
